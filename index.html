<!DOCTYPE html>
<meta charset="utf-8">
<title>Substantial</title>
<style>

@import url(style.css);

.background {
  fill: #fff;
}

</style>
<!-- <script src="//jdfekete.github.io/reorder.js/lib/d3.v3.js"></script> -->
<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="matrix.js"></script>

<div><div class = "title_accent" style = "margin-right:6px; width:10%">green</div><div class = "title">THE <span id = "emp">(UNGREAT)</span> STATE OF SUBSTITUTE TEACHING TODAY</div><div class = "title_accent" style = "margin-left:6px; width:100%">green</div></div>

<div id = "left">
<div id = "axis_label_div"></div>
<div id = "parallel"></div>
</div>

<!-- <div id = "middle">
</div>
 -->
<div id = "right">
  <div id = "sup_col_names"></div>
  <div id = "col_div"></div>
  <div id = "matrix"></div>
</div>

<div id = "info">
  <div id = "stats" class = "info_sec" style = "padding-right:30px; width:20%">
    <h1 id = "state_name"></h1>
  </div>
  <div id = "permits" class = "info_sec" style = "padding-right:30px; width:45%">
  </div>
  <div id = "notes" class = "info_sec" style = "width:20%">
    <h2>Other notes<h2>
  </div>
</div>

<script>
  var abrv_to_name = {
    "AL": "Alabama",
    "AK": "Alaska",
    "AZ": "Arizona",
    "AR": "Arkansas",
    "CA": "California",
    "CO": "Colorado",
    "CT": "Connecticut",
    "DE": "Delaware",
    "DC": "District Of Columbia",
    "FL": "Florida",
    "GA": "Georgia",
    "HI": "Hawaii",
    "ID": "Idaho",
    "IL": "Illinois",
    "IN": "Indiana",
    "IA": "Iowa",
    "KS": "Kansas",
    "KY": "Kentucky",
    "LA": "Louisiana",
    "ME": "Maine",
    "MD": "Maryland",
    "MA": "Massachusetts",
    "MI": "Michigan",
    "MN": "Minnesota",
    "MS": "Mississippi",
    "MO": "Missouri",
    "MT": "Montana",
    "NE": "Nebraska",
    "NV": "Nevada",
    "NH": "New Hampshire",
    "NJ": "New Jersey",
    "NM": "New Mexico",
    "NY": "New York",
    "NC": "North Carolina",
    "ND": "North Dakota",
    "OH": "Ohio",
    "OK": "Oklahoma",
    "OR": "Oregon",
    "PA": "Pennsylvania",
    "RI": "Rhode Island",
    "SC": "South Carolina",
    "SD": "South Dakota",
    "TN": "Tennessee",
    "TX": "Texas",
    "UT": "Utah",
    "VT": "Vermont",
    "VA": "Virginia",
    "WA": "Washington",
    "WV": "West Virginia",
    "WI": "Wisconsin",
    "WY": "Wyoming"
  }

  var margin = {top: 0, right: 0, bottom: 10, left: 0},
      width = 720,
      height = 770;

  var x_scale = d3.scale.ordinal().rangeBands([0, width], .02, 0);
  var y_scale = d3.scale.ordinal().rangeBands([0, height], .3, 0);

  var super_column_labels = d3.select("#sup_col_names").append("g").attr("id", "col_names");

  var column_labels = d3.select("#col_div").append("g")
    .attr("id", "cols");

  var svg = d3.select("#matrix").append("svg")
      .attr("id", "mat_svg")
      .attr("width", width + margin.left + margin.right)
      .attr("height", height + margin.top + margin.bottom)
      .style("margin-left", -margin.left + "px")
    .append("g")
      .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

  selectedState = null; 

  function highlightState(state){
    if (typeof state != "string"){
      state = state['state'] ? state['state'] : state['State'];
    }
    if (selectedState){
      if (selectedState == state){
        removeHighlight();
        return;
      }
      d3.select("#p_label" + selectedState).style("display", "none");
      d3.select('#' + selectedState).attr("fill", "#000");
      d3.select('#' + selectedState).attr("font-family", "Roboto");
    }
    selectedState = state;
    var stateLabel = d3.select('#' + state);
    stateLabel.attr("fill", "#4A4CFF");
    stateLabel.attr("font-family", "Roboto-bold");
    foreground.style("display", function(d, i) {
      return (d["State"] == state) ? "inline": "none";
    });

    d3.select("#p_label" + state).style("display", "inline");

    d3.select("#mat_svg").selectAll(".row")
      .style("opacity", function(d){
        if (d["state"] == state){
          return "1.0";
        } else {
          return "0.1";
        }
      })
      .selectAll(".cell")
      .style("stroke-width","0");

    var state_rows = d3.select("#mat_svg").selectAll(".row")
      .filter(function(d){ return d["state"] == state; })
      .selectAll(".cell")
        .style("stroke", "#555")
        .style("stroke-width","2");

    d3.select("#state_name").text(abrv_to_name[state]);
    d3.select("#info").style("display", "block");
  }

  function removeHighlight(){
    if (selectedState){
      d3.select("#p_label" + selectedState).style("display", "none");
      d3.select('#' + selectedState).attr("fill", "#000");
      d3.select('#' + selectedState).attr("font-family", "Roboto");
    }
    foreground.style("display", "none");
    selectedState = null;
    d3.select("#mat_svg").selectAll(".row")
      .style("opacity", "1.0")
      .selectAll(".cell")
      .style("stroke-width","0");
    d3.select("#state_name").text("");
    d3.select("#info").style("display", "none");
  }

  d3.select("#info")
    .on('click', removeHighlight);
    
  d3.json("data/requirements.json", loadJson);



</script>

<script src="parallel.js"></script>

